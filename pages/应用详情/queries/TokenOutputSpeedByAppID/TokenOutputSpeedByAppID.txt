SELECT
  DATE(created_at) AS x,
  CASE
    WHEN SUM(provider_response_latency) = 0 THEN 0
    ELSE ROUND(CAST((SUM(answer_tokens) / SUM(provider_response_latency)) as NUMERIC), 3)
  END AS y
FROM
  public.messages
WHERE
  app_id = '{{utils.getAppID()}}'
	AND created_at >= '{{SelectDate.selectedOptionValue || utils.getLastDaysRange(7)}}'
GROUP BY
	x
ORDER BY
	x
LIMIT 15;